# ğŸ¤– CLAUDE.md - ConfiguraciÃ³n Maestra Claude Code para Trivance Platform

## ğŸŒŸ WORKSPACE AUTO-CONFIGURADO DESDE TRIVANCE-DEV-CONFIG

**Este archivo fue generado automÃ¡ticamente por el script de setup de trivance-dev-config**

## ğŸ¯ CONFIGURACIÃ“N HÃBRIDA INTELIGENTE

**âœ… Desarrollo Local**: 100% automÃ¡tico - Todo funciona inmediatamente
**âš ï¸ QA/ProducciÃ³n**: ConfiguraciÃ³n manual requerida por seguridad

**Para deployment a QA/ProducciÃ³n ver**: `./trivance-dev-config/docs/DEPLOYMENT.md`

Claude Code debe operar en espaÃ±ol:
- âœ… **Todas las respuestas en espaÃ±ol**
- âœ… **DocumentaciÃ³n generada en espaÃ±ol**
- âœ… **Comentarios de cÃ³digo en espaÃ±ol**
- âœ… **Mensajes de error en espaÃ±ol**
- âœ… **Commits sugeridos en espaÃ±ol**
- âœ… **Explicaciones tÃ©cnicas en espaÃ±ol**
- âš ï¸ **CÃ³digo en inglÃ©s** (variables, funciones - estÃ¡ndar internacional)

## ğŸ—ï¸ WORKSPACE MULTI-REPO COMPLETO

Este workspace fue configurado automÃ¡ticamente desde el repositorio `trivance-dev-config`. 
Estructura completa creada:

```
Trivance-platform/                    # ğŸ“ Workspace principal auto-creado
â”œâ”€â”€ CLAUDE.md                         # â† ESTE ARCHIVO (auto-generado)
â”œâ”€â”€ README.md                         # DocumentaciÃ³n principal (auto-generado)
â”œâ”€â”€ TrivancePlatform.code-workspace   # VS Code multi-repo (auto-configurado)
â”œâ”€â”€ .gitignore                        # Git ignore maestro (auto-creado)
â”œâ”€â”€ start.sh                          # ğŸš€ Comando principal (menÃº interactivo)
â”œâ”€â”€ envs/                             # ğŸ” Configuraciones de environments (no en git)
â”œâ”€â”€ trivance-dev-config/              # ğŸ”§ REPO DE CONFIGURACIONES (clonado)
â”‚   â”œâ”€â”€ .claude/                      # âš™ï¸ ConfiguraciÃ³n Claude Code
â”‚   â”‚   â”œâ”€â”€ settings.json             # Settings principales Claude
â”‚   â”‚   â””â”€â”€ context.md                # Contexto tÃ©cnico del proyecto
â”‚   â”œâ”€â”€ scripts/                      # ğŸš€ Scripts maestros
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â””â”€â”€ orchestrator.sh       # Script de configuraciÃ³n completa
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ smart-start.sh        # Inicio inteligente con validaciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ health-check.sh       # VerificaciÃ³n y auto-fix
â”‚   â”‚   â”‚   â”œâ”€â”€ clean-workspace.sh    # Limpieza del workspace
â”‚   â”‚   â”‚   â”œâ”€â”€ parallel-install.sh   # InstalaciÃ³n paralela rÃ¡pida
â”‚   â”‚   â”‚   â””â”€â”€ post-setup-fixes.sh   # Fixes automÃ¡ticos post-setup
â”‚   â”‚   â”œâ”€â”€ envs.sh                   # GestiÃ³n de environments
â”‚   â”‚   â””â”€â”€ verify-compilation.sh     # Verificar compilaciÃ³n
â”‚   â”œâ”€â”€ templates/                    # ğŸ“„ Templates para auto-generaciÃ³n
â”‚   â”‚   â”œâ”€â”€ CLAUDE.md.template        # Template de este archivo
â”‚   â”‚   â””â”€â”€ TrivancePlatform.code-workspace.template
â”‚   â”œâ”€â”€ docker/                       # ğŸ³ ConfiguraciÃ³n Docker
â”‚   â”‚   â”œâ”€â”€ docker-compose.yaml       # OrquestaciÃ³n de servicios
â”‚   â”‚   â”œâ”€â”€ Dockerfile.*              # ImÃ¡genes optimizadas
â”‚   â”‚   â””â”€â”€ Makefile                  # Comandos simplificados
â”‚   â””â”€â”€ docs/                         # ğŸ“š DocumentaciÃ³n completa
â”‚       â”œâ”€â”€ ONBOARDING.md             # GuÃ­a completa de onboarding
â”‚       â”œâ”€â”€ WORKFLOWS.md              # Procesos y metodologÃ­as
â”‚       â”œâ”€â”€ TROUBLESHOOTING.md        # SoluciÃ³n de problemas
â”‚       â””â”€â”€ DOCKER.md                 # GuÃ­a completa Docker
â”œâ”€â”€ level_up_backoffice/              # ğŸŒ Frontend (React + Vite) - AUTO-CLONADO
â”œâ”€â”€ ms_level_up_management/           # ğŸš€ API Backend (NestJS + GraphQL) - AUTO-CLONADO
â”œâ”€â”€ ms_trivance_auth/                 # ğŸ” Auth Service (NestJS) - AUTO-CLONADO
â””â”€â”€ trivance-mobile/                  # ğŸ“± Mobile App (React Native) - AUTO-CLONADO
```

## ğŸ¯ CONFIGURACIÃ“N CLAUDE CODE OPTIMIZADA

### Archivos de ConfiguraciÃ³n Activos
- **Settings Claude**: `./trivance-dev-config/.claude/settings.json`
- **Contexto TÃ©cnico**: `./trivance-dev-config/.claude/context.md`
- **Comandos Custom**: `./trivance-dev-config/.claude/commands.md`
- **Prompts Predefinidos**: `./trivance-dev-config/.claude/prompts.md`
- **Hooks AutomatizaciÃ³n**: `./trivance-dev-config/.claude/hooks.json`

### ConfiguraciÃ³n Multi-Repo para Claude
Claude Code debe entender que opera en un **workspace multi-repositorio** donde:

1. **4 repositorios integrados** con dependencias entre ellos
2. **Cada repo tiene tecnologÃ­as especÃ­ficas** y propÃ³sitos Ãºnicos
3. **Los cambios pueden ser cross-repo** y requieren coordinaciÃ³n
4. **ConfiguraciÃ³n centralizada** en `trivance-dev-config`
5. **Flujo AI-FIRST** con espaÃ±ol como idioma principal

### URLs de Servicios Auto-Configurados

#### Desarrollo Local (Auto-configurado)
- **Auth Service**: http://localhost:3001 (Docker)
- **Management API**: http://localhost:3000 (Docker)
- **GraphQL Playground**: http://localhost:3000/graphql (Docker)
- **Frontend Admin**: http://localhost:5173 (PM2)
- **Swagger Auth Docs**: http://localhost:3001/api-docs (Docker)
- **ğŸ” Log Viewer**: **http://localhost:4000** (Docker) - Sistema de observabilidad unificado
- **ğŸ“Š Dozzle Logs**: http://localhost:9999 (Docker) - Monitor visual de logs
- **PostgreSQL**: localhost:5432 (Docker)
- **MongoDB**: localhost:27017 (Docker)

#### QA Environment
- **Auth QA**: https://auth-qa.example.com
- **API QA**: https://api-qa.example.com
- **Frontend QA**: https://staging-admin.example.com

## ğŸš€ COMANDO PRINCIPAL PARA CLAUDE CODE

### âš¡ UN SOLO COMANDO PARA TODO
```bash
# COMANDO PRINCIPAL - MENÃš INTERACTIVO
./start.sh

# O CON ARGUMENTOS DIRECTOS:
./start.sh start    # Iniciar servicios
./start.sh stop     # Detener servicios  
./start.sh status   # Ver estado
./start.sh setup    # Configurar desde cero
```

### ğŸ³ MODO HÃBRIDO: DOCKER + PM2

El sistema detecta automÃ¡ticamente si Docker estÃ¡ disponible y usa el modo Ã³ptimo:

- **CON Docker**: Backends y DBs en contenedores + Frontend con PM2 (hot-reload)
- **SIN Docker**: Todo con PM2 (fallback automÃ¡tico)

```bash
# El sistema detecta y te informa:
âœ… Docker detectado - Usando modo hÃ­brido Docker + PM2
# o
âš ï¸  Docker no disponible - Usando PM2 para todo
```

### ğŸ“ Referencia Completa de Comandos
Para ver todos los comandos disponibles y sus rutas completas:
```bash
cat ./trivance-dev-config/docs/COMMANDS.md
```

### ğŸ³ GestiÃ³n Docker (cuando estÃ¡ disponible)
Desde el menÃº principal, opciÃ³n 6:
- Ver logs de contenedores
- Reconstruir imÃ¡genes
- Resetear bases de datos
- Acceder a shell de contenedores
- Monitorear recursos

DocumentaciÃ³n completa: `./trivance-dev-config/docs/DOCKER.md`

## ğŸ—ï¸ ARQUITECTURA TÃ‰CNICA COMPLETA

### level_up_backoffice (Frontend Administrativo)
```typescript
// ğŸŒ Panel de administraciÃ³n web
// Puerto: 5173 (development)
// TecnologÃ­as:
- React 18+ con TypeScript 5.3+
- Vite (bundler + dev server)
- Redux Toolkit + RTK Query (estado global)
- Apollo Client (GraphQL)
- Tailwind CSS + Material-UI (diseÃ±o)
- Vitest (testing)

// PatrÃ³n de componentes estÃ¡ndar
interface ComponentProps {
  // Props siempre tipadas
}

export const ComponentName: React.FC<ComponentProps> = ({ prop1, prop2 }) => {
  // 1. Hooks de React primero
  // 2. Hooks de Redux/Apollo
  // 3. LÃ³gica del componente
  // 4. Efectos y callbacks
  // 5. Return JSX estructurado
}

// SeparaciÃ³n de lÃ³gica: Component.tsx + ComponentLogic.ts
```

### ms_level_up_management (API Backend Principal)
```typescript
// ğŸš€ API principal del sistema
// Puerto: 3000 (development)
// TecnologÃ­as:
- NestJS con TypeScript
- PostgreSQL + Prisma ORM
- GraphQL con Apollo Server
- REST endpoints complementarios
- JWT para autenticaciÃ³n
- Sentry para monitoreo

// PatrÃ³n de mÃ³dulos NestJS
@Module({
  imports: [TypeOrmModule.forFeature([Entity])],
  controllers: [EntityController],
  providers: [EntityService],
  exports: [EntityService]
})
export class EntityModule {}

// Implementaciones:
- PatrÃ³n CQRS
- ValidaciÃ³n con class-validator
- TransformaciÃ³n con class-transformer
- Guards para autenticaciÃ³n/autorizaciÃ³n
```

### ms_trivance_auth (Servicio de AutenticaciÃ³n)
```typescript
// ğŸ” Servicio de autenticaciÃ³n dedicado
// Puerto: 3001 (development)
// TecnologÃ­as:
- NestJS con TypeScript
- MongoDB + Mongoose
- JWT + Refresh Tokens
- bcrypt para password hashing
- Passport para estrategias de auth

// Patrones de seguridad:
- Rate limiting configurado
- ValidaciÃ³n de entrada estricta
- SanitizaciÃ³n de datos
- Logging de eventos de seguridad
- Multi-factor authentication (MFA)
```

### trivance-mobile (AplicaciÃ³n MÃ³vil)
```typescript
// ğŸ“± App mÃ³vil nativa
// TecnologÃ­as:
- React Native con Expo 53
- TypeScript para tipado completo
- React Navigation v6
- Redux Toolkit + Redux Persist
- Firebase Crashlytics
- AsyncStorage para persistencia

// PatrÃ³n de pantallas mÃ³viles
interface ScreenProps {
  navigation: NavigationProp<any>
  route: RouteProp<any>
}

export const ScreenName: React.FC<ScreenProps> = ({ navigation, route }) => {
  // 1. Hooks de Redux para estado global
  // 2. Hooks de navegaciÃ³n
  // 3. LÃ³gica especÃ­fica de la pantalla
  // 4. Manejo de estados de carga/error
  // 5. Return JSX optimizado para mÃ³vil
}
```

## ğŸ¨ PATRONES DE CÃ“DIGO UNIFICADOS

### Convenciones de Naming (EstÃ¡ndar del Equipo)
```typescript
// âœ… Variables y funciones en inglÃ©s (estÃ¡ndar internacional)
const userList = users.map(user => user.name);
const handleUserClick = (userId: string) => { ... };

// âœ… Comentarios siempre en espaÃ±ol
/**
 * Obtiene la lista de usuarios activos de la organizaciÃ³n
 * @param organizationId - ID de la organizaciÃ³n  
 * @returns Lista de usuarios activos con informaciÃ³n completa
 */
const getActiveUsers = async (organizationId: string): Promise<User[]> => {
  // Filtrar solo usuarios con estado activo y validar permisos
  return await userService.findActiveByOrganization(organizationId);
}

// âœ… Interfaces y tipos en inglÃ©s con documentaciÃ³n en espaÃ±ol
interface UserCreateRequest {
  /** Nombre completo del usuario */
  fullName: string;
  /** Email Ãºnico del usuario */
  email: string;
  /** ID de la organizaciÃ³n a la que pertenece */
  organizationId: string;
}
```

### Estructura de Commits (Conventional Commits en EspaÃ±ol)
```bash
# âœ… Usar conventional commits en espaÃ±ol
feat: agregar autenticaciÃ³n de dos factores para usuarios admin
fix: corregir error en cÃ¡lculo de comisiones de eventos
docs: actualizar documentaciÃ³n de endpoints GraphQL
style: mejorar espaciado y diseÃ±o en componente de navegaciÃ³n
refactor: simplificar lÃ³gica de validaciÃ³n de formularios
test: agregar tests unitarios para mÃ³dulo de notificaciones
perf: optimizar consultas de base de datos en reportes
chore: actualizar dependencias de seguridad
```

## ğŸ” CONFIGURACIÃ“N DE VARIABLES DE ENTORNO

### ms_level_up_management (.env) - AUTO-GENERADO
```bash
# ConfiguraciÃ³n de la aplicaciÃ³n
NODE_ENV=development
PORT=3000
APP_NAME=Trivance Management API
APP_VERSION=1.0.0

# Base de datos PostgreSQL
DATABASE_URL=postgresql://username:password@localhost:5432/database_name

# AutenticaciÃ³n y seguridad
JWT_SECRET=REEMPLAZAR_CON_SECRET_SUPER_SEGURO
JWT_EXPIRATION_TIME=3600
REFRESH_TOKEN_EXPIRATION_TIME=604800

# AWS S3 para almacenamiento de archivos
AWS_ACCESS_KEY_ID=REEMPLAZAR_CON_AWS_KEY
AWS_SECRET_ACCESS_KEY=REEMPLAZAR_CON_AWS_SECRET
AWS_REGION=us-east-1
AWS_S3_BUCKET=trivance-uploads-dev

# Monitoreo y logging
SENTRY_DSN=REEMPLAZAR_CON_SENTRY_DSN
LOG_LEVEL=debug

# GraphQL configuraciÃ³n
GRAPHQL_PLAYGROUND=true
GRAPHQL_DEBUG=true
GRAPHQL_INTROSPECTION=true

# Rate limiting
RATE_LIMIT_TTL=60
RATE_LIMIT_LIMIT=100

# CORS
CORS_ORIGIN=http://localhost:5173,http://localhost:3000
```

### ms_trivance_auth (.env) - AUTO-GENERADO
```bash
# ConfiguraciÃ³n de la aplicaciÃ³n
NODE_ENV=development
PORT=3001
APP_NAME=Trivance Auth Service
APP_VERSION=1.0.0

# Base de datos MongoDB
DATABASE_URL=mongodb://localhost:27017/trivance_auth

# AutenticaciÃ³n y tokens
JWT_SECRET=REEMPLAZAR_CON_SECRET_SUPER_SEGURO
JWT_EXPIRATION_TIME=3600
REFRESH_TOKEN_EXPIRATION_TIME=604800

# EncriptaciÃ³n de passwords
BCRYPT_ROUNDS=12

# Rate limiting especÃ­fico para auth
RATE_LIMIT_TTL=60
RATE_LIMIT_LIMIT=50

# ConfiguraciÃ³n de sesiones
SESSION_SECRET=REEMPLAZAR_CON_SESSION_SECRET
SESSION_EXPIRATION=86400

# OAuth providers (opcional)
GOOGLE_CLIENT_ID=REEMPLAZAR_SI_SE_USA_GOOGLE_AUTH
GOOGLE_CLIENT_SECRET=REEMPLAZAR_SI_SE_USA_GOOGLE_AUTH

# Monitoring
SENTRY_DSN=REEMPLAZAR_CON_SENTRY_DSN
```

### level_up_backoffice (.env.local) - AUTO-GENERADO
```bash
# URLs de APIs backend
VITE_API_URL=http://localhost:3000
VITE_AUTH_API_URL=http://localhost:3001
VITE_GRAPHQL_URL=http://localhost:3000/graphql

# ConfiguraciÃ³n de la aplicaciÃ³n
VITE_APP_NAME=Trivance Admin Panel
VITE_APP_VERSION=1.0.0
VITE_APP_DESCRIPTION=Panel administrativo de Trivance Platform

# Monitoreo frontend
VITE_SENTRY_DSN=REEMPLAZAR_CON_SENTRY_FRONTEND_DSN

# APIs externas
VITE_GOOGLE_MAPS_API_KEY=REEMPLAZAR_SI_SE_USA_GOOGLE_MAPS

# ConfiguraciÃ³n de desarrollo
VITE_DEBUG_MODE=true
VITE_MOCK_API=false
```

## ğŸ“š DOCUMENTACIÃ“N DISPONIBLE

### GuÃ­as Actuales
- `trivance-dev-config/docs/ONBOARDING.md` - GuÃ­a completa de onboarding
- `trivance-dev-config/docs/WORKFLOWS.md` - Procesos y metodologÃ­as  
- `trivance-dev-config/docs/TROUBLESHOOTING.md` - SoluciÃ³n de problemas
- `trivance-dev-config/docs/DOCKER.md` - IntegraciÃ³n Docker y modo hÃ­brido

### Por Repositorio
Cada repositorio tiene su propia documentaciÃ³n en el directorio `docs/`:
- Backend Management: `ms_level_up_management/docs/`
- Backend Auth: `ms_trivance_auth/docs/`
- Frontend: `level_up_backoffice/docs/`
- Mobile: `trivance-mobile/docs/`

## ğŸ†˜ SOPORTE Y DOCUMENTACIÃ“N INTEGRADA

### Contactos y EscalaciÃ³n
```typescript
// Sistema de soporte integrado:
// ğŸ“ Nivel 1: DocumentaciÃ³n en trivance-dev-config/docs/
// ğŸ“ Nivel 2: Slack #dev-support (auto-notificaciÃ³n)
// ğŸ“ Nivel 3: GitHub Issues automÃ¡tico con contexto
// ğŸ“ Nivel 4: EscalaciÃ³n a tech lead con mÃ©tricas
```

---

## ğŸ¯ CONFIGURACIÃ“N AUTO-SINCRONIZADA

**Este archivo CLAUDE.md se auto-actualiza desde `trivance-dev-config`**

- ğŸ”„ **Auto-sincronizaciÃ³n**: Cada pull del repo config actualiza este archivo
- ğŸ¤– **Generado automÃ¡ticamente**: Por script `setup.sh`
- ğŸ“… **Ãšltima actualizaciÃ³n**: $(date '+%Y-%m-%d %H:%M:%S')
- ğŸŒŸ **Optimizado para**: Claude Code en espaÃ±ol con workspace multi-repo
- ğŸ”§ **Fuente de verdad**: `trivance-dev-config/templates/CLAUDE.md.template`

**Para actualizar este archivo, edita el template en `trivance-dev-config/templates/CLAUDE.md.template` y ejecuta `./setup.sh`**